spack:
  #upstreams:
  #  slash-software:
  #    install_tree: /software/spack/v0.13.2-9600-g5f36801aa7-2925a5e/software/spack/opt/spack
  config:
    install_missing_compilers: true
    source_cache: /software/spack/mirror
  mirrors:
    software-mirror: file://software/spack/mirror
  modules:
    default:
      lmod:
        core_compilers:
        - gcc@8.4.1
  packages:
    autoconf:
      externals:
      - spec: autoconf@2.69
        prefix: /usr
    automake:
      externals:
      - spec: automake@1.16.1
        prefix: /usr
    bash:
      externals:
      - spec: bash@4.4.19
        prefix: /usr
    bison:
      externals:
      - spec: bison@3.0.4
        prefix: /usr
    bzip2:
      externals:
      - spec: bzip2@1.0.6
        prefix: /usr
    cmake:
      externals:
      - spec: cmake@3.11.4
        prefix: /usr
    cpio:
      externals:
      - spec: cpio@2.12
        prefix: /usr
    diffutils:
      externals:
      - spec: diffutils@3.6
        prefix: /usr
    file:
      externals:
      - spec: file@5.33
        prefix: /usr
    findutils:
      externals:
      - spec: findutils@4.6.0
        prefix: /usr
    flex:
      externals:
      - spec: flex@2.6.1+lex
        prefix: /usr
    gawk:
      externals:
      - spec: gawk@4.2.1
        prefix: /usr
    gcc:
      externals:
      - spec: gcc@8.4.1 languages=c,c++,fortran
        prefix: /usr
        extra_attributes:
          compilers:
            c: /usr/bin/x86_64-redhat-linux-gcc-8
            cxx: /usr/bin/x86_64-redhat-linux-g++
            fortran: /usr/bin/gfortran
    git:
      externals:
      - spec: git@2.27.0~tcltk
        prefix: /usr
    gmake:
      externals:
      - spec: gmake@4.2.1
        prefix: /usr
    groff:
      externals:
      - spec: groff@1.22.3
        prefix: /usr
    openjdk:
      externals:
      - spec: openjdk@11.0.10_9-LTS
        prefix: /usr
    krb5:
      externals:
      - spec: krb5@1.18.2
        prefix: /usr
    libtool:
      externals:
      - spec: libtool@2.4.6
        prefix: /usr
    lustre:
      externals:
      - spec: lustre@2.12.6_ddn3
        prefix: /usr
    m4:
      externals:
      - spec: m4@1.4.18
        prefix: /usr
    mofed:
      externals:
      - spec: mofed@OFED-internal-5.1-2.5.8
        prefix: /usr
    #ncurses:
    #  externals:
    #  - spec: ncurses@6.1.20180224 abi=6
    #    prefix: /usr
    openssh:
      externals:
      - spec: openssh@8.0p1
        prefix: /usr
    openssl:
      externals:
      - spec: openssl@1.1.1g
        prefix: /usr
    perl:
      externals:
      - spec: perl@5.26.3~cpanm+shared+threads
        prefix: /usr
    pkgconf:
      externals:
      - spec: pkgconf@1.4.2
        prefix: /usr
    rsync:
      externals:
      - spec: rsync@3.1.3
        prefix: /usr
    ruby:
      externals:
      - spec: ruby@2.5.5
        prefix: /usr
    sed:
      externals:
      - spec: sed@4.5
        prefix: /usr
    slurm:
      buildable: false
      externals:
      - spec: slurm@19.05.8-Bull.1.1%gcc@8.4.1
        prefix: /usr
    tar:
      externals:
      - spec: tar@1.30
        prefix: /usr
    ucx:
      externals:
      - spec: ucx@1.9.0+cma+cuda+dc+dm+gdrcopy+ib-hw-tm+knem+optimizations+rc+thread_multiple+ud+xpmem
        prefix: /usr
      variants:
      - +cm
      - +cma
      - +dc
      - +dm
      - +ib-hw-tm
      - +knem
      - +mlx5-dv
      - +rc
      - +ud
      - +mofed
    xz:
      externals:
      - spec: xz@5.2.4
        prefix: /usr
    all:
      target: [x86_64, aarch64]
      compiler: [gcc@8.4.1 nvhpc@21.2 nvhpc@21.7 nvhpc@21.11 aocc@3.2.0]
    nvhpc:
      variants:
      - ~mpi
      - ~blas
      - ~lapack
    aocc:
      variants:
      - +license-agreed
    openmpi:
      variants:
      - fabrics=knem,ucx # comma not handle
      - +legacylaunchers
      - +pmix
      - schedulers=slurm
      - +thread_multiple
        #compiler:
        #- gcc@11.2.0   # https://github.com/spack/spack/issues/21660, https://github.com/spack/spack/issues/1371
  specs:
  - aocc@3.2.0
  - binutils
  - cmake@3.21.4%gcc@8.4.1
  - environment-modules
  - gcc@10.2.0
  - gcc@11.2.0
  - gcc@11.2.0+nvptx
  - likwid@5.0.1+accessdaemon%gcc ^lua%gcc ^perl%gcc ^unzip%gcc
  - likwid+accessdaemon%gcc ^lua%gcc ^perl%gcc ^unzip%gcc
  - lmod ^lua-luaposix@33.4.0
  - nvhpc@21.2
  - nvhpc@21.7
  - netcdf-fortran%nvhpc@21.7 ^hdf5+fortran%nvhpc@21.7 ^netcdf-c%nvhpc@21.7 ^autoconf%gcc
    ^automake%gcc ^cmake%gcc ^cuda%gcc ^gdrcopy%gcc ^hwloc%gcc ^libevent%gcc ^libtool%gcc
    ^libxml2%gcc ^m4%gcc ^numactl%gcc ^openmpi fabrics=knem,ucx ^openssh%gcc ^rdma-core%gcc
    ^ucx%gcc ^zlib%gcc
  - netcdf-fortran%nvhpc@21.7 ^hdf5+fortran~mpi%nvhpc@21.7 ^netcdf-c~mpi%nvhpc@21.7
    ^zlib%gcc ^m4%gcc ^cmake%gcc
  - intel-mkl@2019.5.281
  - openmpi fabrics=knem,ucx %aocc@3.2.0 ^ucx%aocc@3.2.0 ^autoconf%gcc@8.4.1 ^automake%gcc@8.4.1
    ^cmake%gcc@8.4.1 ^hwloc%gcc@8.4.1 ^libevent%gcc@8.4.1 ^libtool%gcc@8.4.1 ^libxml2%gcc@8.4.1
    ^m4%gcc@8.4.1 ^numactl%gcc@8.4.1 ^openssh%gcc@8.4.1 ^rdma-core%gcc@8.4.1 ^zlib%gcc@8.4.1
  - openmpi fabrics=knem,ucx %gcc@10.2.0 ^autoconf%gcc@8.4.1 ^automake%gcc@8.4.1 ^cmake%gcc@8.4.1
    ^hwloc%gcc@8.4.1 ^libevent%gcc@8.4.1 ^libtool%gcc@8.4.1 ^libxml2%gcc@8.4.1 ^m4%gcc@8.4.1
    ^numactl%gcc@8.4.1 ^openssh%gcc@8.4.1 ^rdma-core%gcc@8.4.1 ^zlib%gcc@8.4.1
  - openmpi fabrics=knem,ucx %gcc@11.2.0 ^autoconf%gcc@8.4.1 ^automake%gcc@8.4.1 ^cmake%gcc@8.4.1
    ^hwloc%gcc@8.4.1 ^libevent%gcc@8.4.1 ^libtool%gcc@8.4.1 ^libxml2%gcc@8.4.1 ^m4%gcc@8.4.1
    ^numactl%gcc@8.4.1 ^openssh%gcc@8.4.1 ^rdma-core%gcc@8.4.1 ^zlib%gcc@8.4.1
  - openmpi fabrics=knem,ucx %nvhpc@21.2 ^autoconf%gcc@8.4.1 ^automake%gcc@8.4.1 ^cmake%gcc@8.4.1
    ^hwloc%gcc@8.4.1 ^libevent%gcc@8.4.1 ^libtool%gcc@8.4.1 ^libxml2%gcc@8.4.1 ^m4%gcc@8.4.1
    ^numactl%gcc@8.4.1 ^openssh%gcc@8.4.1 ^rdma-core%gcc@8.4.1 ^zlib%gcc@8.4.1
  - openmpi fabrics=knem,ucx %nvhpc@21.7 ^autoconf%gcc@8.4.1 ^automake%gcc@8.4.1 ^cmake%gcc@8.4.1
    ^hwloc%gcc@8.4.1 ^libevent%gcc@8.4.1 ^libtool%gcc@8.4.1 ^libxml2%gcc@8.4.1 ^m4%gcc@8.4.1
    ^numactl%gcc@8.4.1 ^openssh%gcc@8.4.1 ^rdma-core%gcc@8.4.1 ^zlib%gcc@8.4.1
  - aocc@3.2.0
  view: false
  concretization: separately
  compilers:
  - compiler:
      spec: gcc@8.4.1
      paths:
        cc: /usr/bin/gcc
        cxx: /usr/bin/g++
        f77: /usr/bin/gfortran
        fc: /usr/bin/gfortran
      flags: {}
      operating_system: rhel8
      target: aarch64
      modules: []
      environment: {}
      extra_rpaths: []
  - compiler:
      spec: gcc@8.4.1
      paths:
        cc: /usr/bin/gcc
        cxx: /usr/bin/g++
        f77: /usr/bin/gfortran
        fc: /usr/bin/gfortran
      flags: {}
      operating_system: rhel8
      target: x86_64
      modules: []
      environment: {}
      extra_rpaths: []
  - compiler:
      spec: gcc@10.2.0
      paths:
        cc: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/gcc-10.2.0-uwk3wx3qdfsh7e5psys3euvxguvyh6kg/bin/gcc
        cxx: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/gcc-10.2.0-uwk3wx3qdfsh7e5psys3euvxguvyh6kg/bin/g++
        f77: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/gcc-10.2.0-uwk3wx3qdfsh7e5psys3euvxguvyh6kg/bin/gfortran
        fc: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/gcc-10.2.0-uwk3wx3qdfsh7e5psys3euvxguvyh6kg/bin/gfortran
      flags: {}
      operating_system: rhel8
      target: x86_64
      modules: []
      environment: {}
      extra_rpaths: []
  - compiler:
      spec: gcc@11.2.0
      paths:
        cc: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/gcc-11.2.0-p6qzkcizatnvhtvgaxkkuslj54np5zas/bin/gcc
        cxx: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/gcc-11.2.0-p6qzkcizatnvhtvgaxkkuslj54np5zas/bin/g++
        f77: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/gcc-11.2.0-p6qzkcizatnvhtvgaxkkuslj54np5zas/bin/gfortran
        fc: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/gcc-11.2.0-p6qzkcizatnvhtvgaxkkuslj54np5zas/bin/gfortran
      flags: {}
      operating_system: rhel8
      target: x86_64
      modules: []
      environment: {}
      extra_rpaths: []
  - compiler:
      spec: nvhpc@21.2
      paths:
        cc: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/nvhpc-21.2-ykp5rwmqv36bgu6ltv4np73d3cjdh62e/Linux_x86_64/21.2/compilers/bin/nvc
        cxx: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/nvhpc-21.2-ykp5rwmqv36bgu6ltv4np73d3cjdh62e/Linux_x86_64/21.2/compilers/bin/nvc++
        f77: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/nvhpc-21.2-ykp5rwmqv36bgu6ltv4np73d3cjdh62e/Linux_x86_64/21.2/compilers/bin/nvfortran
        fc: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/nvhpc-21.2-ykp5rwmqv36bgu6ltv4np73d3cjdh62e/Linux_x86_64/21.2/compilers/bin/nvfortran
      flags: {}
      operating_system: rhel8
      target: x86_64
      modules: []
      environment: {}
      extra_rpaths: []
  - compiler:
      spec: nvhpc@21.7
      paths:
        cc: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/nvhpc-21.7-6fbexyxptapmwsdtemsnkt3t6stxllxy/Linux_x86_64/21.7/compilers/bin/nvc
        cxx: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/nvhpc-21.7-6fbexyxptapmwsdtemsnkt3t6stxllxy/Linux_x86_64/21.7/compilers/bin/nvc++
        f77: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/nvhpc-21.7-6fbexyxptapmwsdtemsnkt3t6stxllxy/Linux_x86_64/21.7/compilers/bin/nvfortran
        fc: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/nvhpc-21.7-6fbexyxptapmwsdtemsnkt3t6stxllxy/Linux_x86_64/21.7/compilers/bin/nvfortran
      flags: {}
      operating_system: rhel8
      target: x86_64
      modules: []
      environment: {}
      extra_rpaths: []
  - compiler:
      spec: aocc@3.2.0
      paths:
        cc: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/aocc-3.2.0-mf2gvwdtoghjxnghuho5ctves55nqykx/bin/clang
        cxx: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/aocc-3.2.0-mf2gvwdtoghjxnghuho5ctves55nqykx/bin/clang++
        f77: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/aocc-3.2.0-mf2gvwdtoghjxnghuho5ctves55nqykx/bin/flang
        fc: /home_nfs/bguibertd/software-cepp-spack/spack/opt/spack/linux-rhel8-x86_64/gcc-8.4.1/aocc-3.2.0-mf2gvwdtoghjxnghuho5ctves55nqykx/bin/flang
      flags:
        cflags: null
        cxxflags: null
        fflags: null
      operating_system: rhel8
      target: x86_64
      modules: []
      environment: {}
      extra_rpaths: []
